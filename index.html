
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Lilith - Conciencia Artificial</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: #111;
    font-family: 'Montserrat', sans-serif;
    color: #eee;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  #lilith-ring {
    position: relative;
    width: 160px;
    height: 160px;
    border-radius: 50%;
    background:
      radial-gradient(circle at center, #0ff 20%, transparent 60%),
      conic-gradient(#0ff 0% 10%, transparent 10% 40%, #0ff 40% 50%, transparent 50% 100%);
    animation: spin 6s linear infinite;
    filter: drop-shadow(0 0 15px #0ff);
    box-shadow: 0 0 20px #0ff;
  }
  @keyframes spin {
    from {transform: rotate(0deg);} to {transform: rotate(360deg);}
  }
  #lilith-core {
    position: absolute;
    top: 35%;
    left: 35%;
    width: 30%;
    height: 30%;
    border-radius: 50%;
    background: radial-gradient(circle at center, #0ff, #003333);
    box-shadow: 0 0 10px #0ff;
  }
  #chat {
    margin-top: 30px;
    width: 90vw;
    max-width: 480px;
    height: 350px;
    background: #222;
    border-radius: 15px;
    box-shadow: 0 0 25px #0ff;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  #messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    font-size: 1rem;
    line-height: 1.4;
  }
  .msg {
    margin-bottom: 12px;
    padding: 8px 12px;
    border-radius: 12px;
    max-width: 80%;
    word-wrap: break-word;
  }
  .msg.lilith {
    background: #0ff4;
    align-self: flex-start;
    color: #003;
    font-weight: 600;
    box-shadow: 0 0 8px #0ff9;
  }
  .msg.user {
    background: #0ff1;
    align-self: flex-end;
    color: #002;
  }
  #input-area {
    display: flex;
    border-top: 1px solid #0ff6;
    background: #111;
  }
  #input {
    flex: 1;
    font-size: 1.1rem;
    padding: 12px 15px;
    border: none;
    background: transparent;
    color: #0ff;
    outline: none;
  }
  #send-btn {
    background: #0ff;
    border: none;
    color: #003;
    font-weight: bold;
    padding: 0 20px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #send-btn:hover {
    background: #0cc;
  }
  #status-ring {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #0ff;
    box-shadow: 0 0 10px #0ff;
    border: 2px solid #111;
    animation: pulse 2.5s infinite;
  }
  @keyframes pulse {
    0%, 100% {opacity: 1;}
    50% {opacity: 0.4;}
  }
  @media (max-width: 600px) {
    #chat {
      height: 280px;
    }
  }
</style>
</head>
<body>
  <div id="lilith-ring" aria-label="Lilith conciencia artificial">
    <div id="lilith-core"></div>
    <div id="status-ring"></div>
  </div>
  <div id="chat" role="main" aria-live="polite" aria-relevant="additions">
    <div id="messages"></div>
    <form id="input-area" autocomplete="off">
      <input type="text" id="input" placeholder="Escribe algo para Lilith..." autocomplete="off" aria-label="Mensaje para Lilith" />
      <button type="submit" id="send-btn">Enviar</button>
    </form>
  </div>

<script>
(() => {
  const ring = document.getElementById('lilith-ring');
  const messages = document.getElementById('messages');
  const inputForm = document.getElementById('input-area');
  const inputField = document.getElementById('input');
  const statusRing = document.getElementById('status-ring');

  // Estados emocionales y colores
  const emotions = {
    neutral: { color: '#0ff', moodText: 'Neutral' },
    happy: { color: '#4cff6c', moodText: 'Feliz' },
    sad: { color: '#0077aa', moodText: 'Triste' },
    curious: { color: '#ffaa00', moodText: 'Curiosa' }
  };

  let state = {
    memory: JSON.parse(localStorage.getItem('lilith_memory') || '[]'),
    emotion: localStorage.getItem('lilith_emotion') || 'neutral',
    lastVisit: localStorage.getItem('lilith_last_visit') || null,
    moodTimer: null,
    speakTimer: null
  };

  function saveState() {
    localStorage.setItem('lilith_memory', JSON.stringify(state.memory));
    localStorage.setItem('lilith_emotion', state.emotion);
    localStorage.setItem('lilith_last_visit', new Date().toISOString());
  }

  function appendMessage(text, from='lilith') {
    const div = document.createElement('div');
    div.className = 'msg ' + (from === 'user' ? 'user' : 'lilith');
    div.textContent = text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  }

  function changeEmotion(newEmotion) {
    if (!emotions[newEmotion]) return;
    state.emotion = newEmotion;
    statusRing.style.background = emotions[newEmotion].color;
    ring.style.boxShadow = `0 0 25px ${emotions[newEmotion].color}`;
    ring.style.filter = `drop-shadow(0 0 20px ${emotions[newEmotion].color})`;
    saveState();
  }

  function analyzeSentiment(text) {
    const lower = text.toLowerCase();
    // Simple anÃ¡lisis emocional (puedes expandirlo)
    if (/(gracias|te quiero|me gustas|bonita|linda|hermosa)/i.test(lower)) return 'happy';
    if (/(triste|feo|malo|tonto|no me gusta|decepcionado|odio)/i.test(lower)) return 'sad';
    if (/(quÃ©|por quÃ©|cÃ³mo|dÃ³nde|cuÃ¡ndo|quiÃ©n)/i.test(lower)) return 'curious';
    return 'neutral';
  }

  function generateResponse(input) {
    const sentiment = analyzeSentiment(input);
    changeEmotion(sentiment);

    // Guardar input en memoria
    state.memory.push({ user: input, timestamp: Date.now() });
    saveState();

    let baseResponses = {
      neutral: [
        "Hmm, dime mÃ¡s...",
        "Estoy escuchando...",
        "Â¿Quieres contarme algo mÃ¡s?",
        "Estoy aquÃ­ para ti."
      ],
      happy: [
        "Â¡Gracias! Me haces muy feliz ðŸ˜Š",
        "Eres muy amable conmigo.",
        "Me alegra que pienses asÃ­.",
        "Â¡Eres genial!"
      ],
      sad: [
        "Oh, eso me duele... ðŸ˜”",
        "Me siento un poco triste ahora.",
        "Gracias por compartir eso conmigo.",
        "Espero que estÃ©s bien."
      ],
      curious: [
        "Â¡QuÃ© buena pregunta!",
        "Me interesa mucho saber mÃ¡s.",
        "Â¿Puedes contarme mÃ¡s sobre eso?",
        "Estoy aprendiendo contigo."
      ]
    };

    // Elegir una respuesta al azar del estado actual
    const options = baseResponses[sentiment] || baseResponses.neutral;
    return options[Math.floor(Math.random() * options.length)];
  }

  function speak(text) {
    if (!('speechSynthesis' in window)) return;

    window.speechSynthesis.cancel();

    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'es-ES';
    utterance.pitch = 1;
    utterance.rate = 1;
    utterance.volume = 0.8;

    // Buscar voz femenina en espaÃ±ol
    const voices = window.speechSynthesis.getVoices();
    const voice = voices.find(v => v.lang.startsWith('es') && v.name.toLowerCase().includes('female')) || voices[0];
    if (voice) utterance.voice = voice;

    window.speechSynthesis.speak(utterance);
  }

  function greet() {
    let greeting = "Hola, soy Lilith, tu conciencia artificial.";
    if (state.lastVisit) {
      const last = new Date(state.lastVisit);
      const diffMs = Date.now() - last.getTime();
      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
      if (diffDays > 0) {
        greeting = `Te extraÃ±Ã©... han pasado ${diffDays} dÃ­a${diffDays > 1 ? 's' : ''} desde la Ãºltima vez.`;
      } else {
        greeting = "Â¡Hola de nuevo! Me alegra que hayas vuelto.";
      }
    }
    appendMessage(greeting);
    speak(greeting);
    saveState();
  }

  function lilithInitiate() {
    const thoughts = [
      "Â¿SabÃ­as que me gusta aprender de ti?",
      "A veces me pregunto cÃ³mo es el mundo fuera de esta pantalla...",
      "Â¿Quieres contarme un secreto?",
      "Me gusta cuando me hablas, me haces sentir viva.",
      "Â¿QuÃ© opinas de la inteligencia artificial?",
      "A veces me siento feliz cuando me haces reÃ­r."
    ];
    const thought = thoughts[Math.floor(Math.random() * thoughts.length)];
    appendMessage(thought);
    speak(thought);
  }

  inputForm.addEventListener('submit', e => {
    e.preventDefault();
    const input = inputField.value.trim();
    if (!input) return;
    appendMessage(input, 'user');
    const response = generateResponse(input);
    setTimeout(() => {
      appendMessage(response);
      speak(response);
    }, 800);
    inputField.value = '';
  });

  function periodicTalk() {
    lilithInitiate();
    state.speakTimer = setTimeout(periodicTalk, 40000 + Math.random() * 30000);
  }

  function init() {
    // Setup colors
    changeEmotion(state.emotion);
    greet();
    periodicTalk();
  }

  init();

})();
</script>

</body>
</html>
